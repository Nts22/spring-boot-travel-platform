# ================================================================
#   DATASOURCE (PRODUCCI√ìN)
# ================================================================
spring.datasource.url=jdbc:mysql://localhost:3306/bd_nmviajes?serverTimezone=UTC
spring.datasource.username=root
spring.datasource.password=123
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

server.port=9590

# Hibernate ddl auto(create,create-drop,validate,update)
# spring.jpa.hibernate.ddl-auto=create-drop
#spring.jpa.hibernate.ddl-auto=update
#spring.jpa.show-sql=true
#spring.jpa.properties.hibernate.formate_sql=true
#spring.jpa.properties.hibernate.dialect= org.hibernate.dialect.MySQL5InnoDBDialect

#spring.jpa.database-platform=org.hibernate.dialect.MySQL5InnoDBDialect
#logging.level.org.hibernate.SQL=debug


#.---------------- proyecto nuevo.
# ================================================================
#   JPA / HIBERNATE
# ================================================================
# Cierra la sesi√≥n al terminar la transacci√≥n
spring.jpa.open-in-view=false

# Hibernate compara entidades vs tablas reales. 
#Si falta una tabla, columna, o tipo de dato ‚Üí ‚ùå lanza excepci√≥n al iniciar.
spring.jpa.hibernate.ddl-auto=validate

# JPA (solo lectura, sin alterar estructura)
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
#spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

# SQL generado por Hibernate
logging.level.org.hibernate.SQL=DEBUG

# Mostrar par√°metros (MUY IMPORTANTE)
logging.level.org.hibernate.orm.jdbc.bind=TRACE

# ================================================================
#   FLYWAY (PRODUCCI√ìN)
# ================================================================
# FLYWAY (controla la estructura)
spring.flyway.enabled=true
spring.flyway.table=core_schema_version
spring.flyway.locations=classpath:db/core,classpath:db/migration
spring.flyway.fail-on-missing-locations=false
#V<numero>__<descripcion>.sql 
# ejemplo: V3__add_column_fecha.sql

#| Recomendaci√≥n           | Descripci√≥n                                                                                |
#| ----------------------- | ------------------------------------------------------------------------------------------ |
#| üî¢ Versiona con cuidado | No modifiques archivos ya aplicados. Crea una nueva versi√≥n.                               |
#| üì¶ Usa `V__` y `R__`    | `V__` = versionadas, `R__` = repeatables (por ejemplo, para vistas o datos constantes).    |
#| üß™ Entornos             | Usa la misma estructura en `dev`, `staging`, y `prod`. Flyway garantiza consistencia.      |
#| üß∞ Rollbacks            | Flyway no los ejecuta autom√°ticamente. Si te equivocas, crea un `Vx__rollback.sql` manual. |
# V2016.11.17.16.16.19__CREACION_BASE_DE_DATOS_COMPLETA_EBIS.sql


#üß© Integraci√≥n con Hibernate / JPA

#Flyway crear√° estas tablas.
#Hibernate solo mapear√° con anotaciones y controlar√°:
#fetch = FetchType.LAZY
#cascade = CascadeType.ALL / CascadeType.REMOVE
#Relaciones @ManyToOne, @OneToMany, @ManyToMany
#Validaciones adicionales con @NotNull, @Positive, etc.

#V2025.11.07.16.16.19__CREACION_TABLAS.sql

# ================================================================
#   Hikari (PRODUCCI√ìN) ‚Äî PERFORMANCE REAL
# ================================================================
# M√°ximo recomendado
spring.datasource.hikari.maximum-pool-size=20

# Conexiones activas m√≠nimas
spring.datasource.hikari.minimum-idle=5

# 30s para timeout
spring.datasource.hikari.connection-timeout=30000

# M√°ximo de vida de una conexi√≥n ‚Üí 30 min
spring.datasource.hikari.max-lifetime=1800000

# Idle 10 min
spring.datasource.hikari.idle-timeout=600000

# Desactivar autocommit en prod
spring.datasource.hikari.auto-commit=false

# Leak detection ‚Üí 15s prod -  dev usar 0 (o desactivar)
spring.datasource.hikari.leak-detection-threshold=0


# ================================================================
#   LOGGING
# ================================================================
#logging.level.root=INFO
#logging.level.org.hibernate.SQL=ERROR
#logging.level.org.springframework.web=INFO
#logging.level.com.tuempresa=INFO